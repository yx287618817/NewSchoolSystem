<!DOCTYPE html>
<html lang="en">
{% load staticfiles %}
<head>
  <meta charset='utf-8'>
  <meta name="description" content="不超过150个字符"/>
  <meta name="keywords" content=""/>
  <meta name="author" content="Paul, 287618817@qq.com"/>
  <meta name="robots" content="index,follow"/>
  <title>学生端</title>
  <link rel="shortcut icon" href="{% static 'html_icon.ico' %}">
  <link rel="stylesheet" href="{% static 'bootstrap-3.3.7-dist/css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'bootstrap-3.3.7-dist/css/bootstrap-theme.min.css' %}">
  <script src="{% static 'jquery-3.3.1.js' %}"></script>
  <script src="{% static 'bootstrap-3.3.7-dist/js/bootstrap.min.js' %}"></script>
{#  <link rel="stylesheet" href="{% static 'register_two/css/register_two_css.css' %}">#}
  <title>Title</title>
  <style>
    .d1{
      border: 1px solid red;
      display: inline-block;
      position: absolute;
      top: 200px;
      left: 50%;
      margin-left: -215px;
    }
    .input-one{
      font-size: 0;
      background: url("{% static 'main_template/image/1.jpg' %}");
      width: 430px;
      height: 228px;
      display: none;
    }
    .d3{
      width: 200px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <form action="/update_user_photo/" method="post" enctype="multipart/form-data" class="form1">
    <div class="d1">
      <input class="input-one" type="file" name="update_user_photo" onchange="fun(this)">
      <input class="btn btn-info submit-one d3 center-block" type="submit" value="确定提交">
    </div>
  </form>
<script>
    function fun(self) {
        let file = $('.input-one').get(0).files[0]; //获取上传的文件
        let data = new FormData();
        data.append('file', file);
        $.ajax({
            url: '/update_user_photo/',
            type: 'POST',
            data: data,
            success: function(arg) {
            console.log(arg['isSuccess'])
        },
            processData: false,
            contentType: false,
        })
    }

{#<form id="form1">#}
{#     <label for="exampleInputEmail1">头像</label>#}
{#      <input type="button" value="上传图片" onclick="f.click()" class="btn_mouseout"/><br>#}
{#       <p><input type="file" id="f" name="f" onchange="sc(this);" style="display:none"/></p>#}
{# </form>#}
{#<div id="result"></div>#}
{#function sc(){#}
{#    let animateimg = $("#f").val(); //获取上传的图片名 带//#}
{#    let imgarr=animateimg.split('\\'); //分割#}
{#    let myimg=imgarr[imgarr.length-1]; //去掉 // 获取图片名#}
{#    let houzui = myimg.lastIndexOf('.'); //获取 . 出现的位置#}
{#    let ext = myimg.substring(houzui, myimg.length).toUpperCase();  //切割 . 获取文件后缀#}
{##}
{#    let file = $('#f').get(0).files[0]; //获取上传的文件#}
{#    let fileSize = file.size;           //获取上传的文件大小#}
{#    let maxSize = 1048576;              //最大1MB#}
{#    if(ext !='.PNG' && ext !='.GIF' && ext !='.JPG' && ext !='.JPEG' && ext !='.BMP'){#}
{#        parent.layer.msg('文件类型错误,请上传图片类型');#}
{#        return false;#}
{#    }else if(parseInt(fileSize) >= parseInt(maxSize)){#}
{#        parent.layer.msg('上传的文件不能超过1MB');#}
{#        return false;#}
{#    }else{#}
{#        var data = new FormData($('#form1')[0]);#}
{#        $.ajax({#}
{#            url: "/update_user_photo",#}
{#            type: 'POST',#}
{#            data: data,#}
{#            dataType: 'JSON',#}
{#            cache: false,#}
{#            processData: false,#}
{#            contentType: false#}
{#        }).done(function(ret){#}
{#            if(ret['isSuccess']){#}
{#                let result = '';#}
{#                let result1 = '';#}
{#                result += '<img src="' + '__ROAD__' + ret['f']  + '" width="100">';#}
{#                result1 += '<input value="' + ret['f']  + '" name="user_headimg" style="display:none;">';#}
{#                $('#result').html(result);#}
{#                $('#show').html(result1);#}
{#                layer.msg('上传成功');#}
{#            }else{#}
{#                layer.msg('上传失败');#}
{#            }#}
{#        });#}
{#        return false;#}
{#       }#}
{#    }#}
</script>
</body>
</html>